
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MY SPORT</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { margin: 0; padding: 0; overflow: hidden; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 3px; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;
        const { Trophy, Users, Globe, User } = lucide;

        const SPORT_TYPES = {
          BASEBALL: 'baseball',
          VOLLEYBALL: 'volleyball',
          BADMINTON: 'badminton'
        };

        const sportsData = {
          baseball: {
            id: 'baseball',
            type: SPORT_TYPES.BASEBALL,
            title: '한화 이글스',
            subtitle: '2025 KBO 시즌 최종 순위',
            icon: Trophy,
            bgColor: 'bg-gray-800',
            ranking: { rank: 2, wins: 83, losses: 57, draws: 4, winRate: 0.593, gameDiff: 1.5 }
          },
          volleyball: {
            id: 'volleyball',
            type: SPORT_TYPES.VOLLEYBALL,
            title: '현대캐피탈 스카이워커스',
            subtitle: 'V-리그 시즌 중',
            icon: Users,
            bgColor: 'bg-gray-800',
            ranking: { rank: 2, wins: 8, losses: 6, points: 1, setRatio: 1.033 },
            nextMatch: { opponent: 'vs 대한항공', date: '12월 16일', time: '19:00', location: '천안유관순체육관' }
          },
          worldcup: {
            id: 'worldcup',
            title: '2026 FIFA 월드컵',
            subtitle: '개막 D-540',
            icon: Globe,
            bgColor: 'bg-gray-800'
          },
          anseyoung: {
            id: 'anseyoung',
            type: SPORT_TYPES.BADMINTON,
            title: '안세영',
            subtitle: 'BWF 월드투어 파이널스',
            icon: User,
            bgColor: 'bg-gray-800',
            tournament: {
              name: 'BWF 월드투어 파이널스',
              location: '중국 항저우',
              startDate: new Date('2025-12-17'),
              endDate: new Date('2025-12-21'),
              status: 'upcoming'
            }
          }
        };

        const SportCard = ({ data, onClick }) => {
          if (!data) {
            return (
              <div className="bg-gray-800 border border-gray-700 flex items-center justify-center">
                <p className="text-gray-500 text-lg">시즌 대기 중</p>
              </div>
            );
          }

          const Icon = data.icon;
          
          const getTournamentStatus = (tournament) => {
            if (!tournament) return null;
            const today = new Date();
            const start = tournament.startDate;
            const end = tournament.endDate;
            
            if (today < start) {
              const daysUntil = Math.ceil((start - today) / (24 * 60 * 60 * 1000));
              return { status: 'upcoming', text: `D-${daysUntil}` };
            } else if (today >= start && today <= end) {
              return { status: 'ongoing', text: '경기 중' };
            } else {
              return { status: 'completed', text: '대회 종료' };
            }
          };
          
          const tournamentStatus = data.tournament ? getTournamentStatus(data.tournament) : null;
          
          const formatDate = (date) => {
            return date.toLocaleDateString('ko-KR', { month: 'short', day: 'numeric' });
          };
          
          return (
            <div
              onClick={onClick}
              className={`${data.bgColor} border border-gray-700 cursor-pointer transform transition-all duration-300 hover:brightness-110 flex items-center justify-center p-6 relative overflow-y-auto custom-scrollbar`}
            >
              <div className="flex flex-col items-center justify-start text-white text-center w-full">
                <Icon size={48} strokeWidth={1.5} className="mb-4 flex-shrink-0" />
                <h2 className="text-2xl font-bold mb-2 flex-shrink-0">{data.title}</h2>
                <p className="text-white text-opacity-90 text-sm mb-3 flex-shrink-0">{data.subtitle}</p>
                
                {/* 배드민턴 대회 정보 */}
                {data.tournament && tournamentStatus?.status !== 'ongoing' && (
                  <div className="mt-3 bg-black bg-opacity-30 px-4 py-3 rounded-lg w-full max-w-xs flex-shrink-0">
                    <div className="space-y-1.5 text-xs">
                      <div className="flex items-center justify-between">
                        <span className="text-white text-opacity-70">대회</span>
                        <span className="font-semibold text-right">{data.tournament.name}</span>
                      </div>
                      <div className="flex items-center justify-between">
                        <span className="text-white text-opacity-70">장소</span>
                        <span className="font-semibold">{data.tournament.location}</span>
                      </div>
                      <div className="flex items-center justify-between">
                        <span className="text-white text-opacity-70">기간</span>
                        <span className="font-semibold text-xs">
                          {formatDate(data.tournament.startDate)} ~ {formatDate(data.tournament.endDate)}
                        </span>
                      </div>
                      {tournamentStatus && (
                        <div className="pt-2 mt-2 border-t border-white border-opacity-20 text-center">
                          <span className={`inline-block px-3 py-1 rounded-full text-xs font-bold ${
                            tournamentStatus.status === 'ongoing' ? 'bg-green-500 text-white animate-pulse' :
                            tournamentStatus.status === 'upcoming' ? 'bg-blue-500 text-white' :
                            'bg-gray-500 text-white'
                          }`}>
                            {tournamentStatus.text}
                          </span>
                        </div>
                      )}
                    </div>
                  </div>
                )}
                
                {/* 야구 순위 */}
                {data.ranking && data.type === SPORT_TYPES.BASEBALL && (
                  <div className="mt-3 bg-black bg-opacity-30 px-4 py-3 rounded-lg flex-shrink-0">
                    <div className="flex items-center gap-3">
                      <div className="text-center">
                        <p className="text-4xl font-bold">{data.ranking.rank}</p>
                        <p className="text-xs text-white text-opacity-70 mt-1">순위</p>
                      </div>
                      <div className="h-10 w-px bg-white bg-opacity-30" />
                      <div className="text-left space-y-0.5">
                        <p className="text-xs">
                          <span className="font-semibold">{data.ranking.wins}</span> 승 · 
                          <span className="font-semibold">{data.ranking.losses}</span> 패 · 
                          <span className="font-semibold">{data.ranking.draws}</span> 무
                        </p>
                        <p className="text-xs">
                          승률 <span className="font-semibold">{data.ranking.winRate.toFixed(3)}</span> · 
                          <span className="text-xs">게임차 {data.ranking.gameDiff}</span>
                        </p>
                      </div>
                    </div>
                  </div>
                )}
                
                {/* 배구 순위 */}
                {data.ranking && data.type === SPORT_TYPES.VOLLEYBALL && (
                  <div className="mt-3 bg-black bg-opacity-30 px-4 py-3 rounded-lg flex-shrink-0">
                    <div className="flex items-center gap-3 mb-2">
                      <div className="text-center">
                        <p className="text-4xl font-bold">{data.ranking.rank}</p>
                        <p className="text-xs text-white text-opacity-70 mt-1">순위</p>
                      </div>
                      <div className="h-10 w-px bg-white bg-opacity-30" />
                      <div className="text-left space-y-0.5">
                        <p className="text-xs">
                          <span className="font-semibold">{data.ranking.wins}</span> 승 · 
                          <span className="font-semibold">{data.ranking.losses}</span> 패
                        </p>
                        <p className="text-xs">
                          승점 <span className="font-semibold">{data.ranking.points}</span> 점 · 
                          <span className="text-xs">세트득실 {data.ranking.setRatio.toFixed(3)}</span>
                        </p>
                      </div>
                    </div>
                    {data.nextMatch && (
                      <div className="pt-2 mt-2 border-t border-white border-opacity-20">
                        <p className="text-xs text-white text-opacity-70 mb-1.5">다음 경기</p>
                        <div className="bg-white bg-opacity-10 rounded px-2.5 py-2">
                          <p className="font-bold text-xs mb-1">{data.nextMatch.opponent}</p>
                          <div className="flex items-center gap-2 text-xs text-white text-opacity-80">
                            <span>{data.nextMatch.date}</span>
                            <span>•</span>
                            <span>{data.nextMatch.time}</span>
                          </div>
                          <p className="text-xs text-white text-opacity-60 mt-0.5">{data.nextMatch.location}</p>
                        </div>
                      </div>
                    )}
                  </div>
                )}
              </div>
            </div>
          );
        };

        const SportsDashboard = () => {
          const [currentPage, setCurrentPage] = useState('home');
          const [currentRoute, setCurrentRoute] = useState('');
          const [liveRankings, setLiveRankings] = useState(null);
          const [isLoading, setIsLoading] = useState(true);
          
          useEffect(() => {
            const fetchLiveRankings = async () => {
              try {
                const response = await fetch('./data/sports-rankings.json');
                if (!response.ok) throw new Error('Failed to fetch');
                const data = await response.json();
                setLiveRankings(data);
                console.log('✅ 실시간 순위 로딩 완료:', data);
              } catch (error) {
                console.warn('⚠️ 실시간 데이터를 불러올 수 없습니다. 기본 데이터를 사용합니다.');
              } finally {
                setIsLoading(false);
              }
            };
            
            const timeout = setTimeout(() => setIsLoading(false), 3000);
            fetchLiveRankings().finally(() => clearTimeout(timeout));
          }, []);
          
          const updatedSportsData = useMemo(() => {
            const data = { ...sportsData };
            
            if (liveRankings?.baseball) {
              data.baseball = { ...data.baseball, ranking: liveRankings.baseball };
            }
            
            if (liveRankings?.volleyball) {
              data.volleyball = { ...data.volleyball, ranking: liveRankings.volleyball };
            }
            
            return data;
          }, [liveRankings]);

          const layout = useMemo(() => {
            return [
              updatedSportsData.baseball,
              updatedSportsData.volleyball,
              updatedSportsData.worldcup,
              updatedSportsData.anseyoung
            ];
          }, [updatedSportsData]);
          
          const handleCardClick = (route) => {
            setCurrentRoute(route);
            setCurrentPage('detail');
          };
          
          const handleBackToHome = () => {
            setCurrentPage('home');
            setCurrentRoute('');
          };
          
          const formatUpdateTime = (dateString) => {
            const date = new Date(dateString);
            return date.toLocaleString('ko-KR', {
              month: 'short',
              day: 'numeric',
              hour: '2-digit',
              minute: '2-digit'
            });
          };
          
          if (isLoading) {
            return (
              <div className="h-screen bg-gray-900 flex items-center justify-center">
                <div className="text-center">
                  <div className="animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500 mx-auto mb-4" />
                  <p className="text-white text-xl">실시간 순위 불러오는 중...</p>
                </div>
              </div>
            );
          }
          
          if (currentPage === 'detail') {
            return (
              <div className="min-h-screen bg-gray-100 p-8">
                <div className="max-w-4xl mx-auto">
                  <button
                    onClick={handleBackToHome}
                    className="mb-6 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
                  >
                    ← 대시보드로 돌아가기
                  </button>
                  <div className="bg-white rounded-2xl p-12 shadow-lg">
                    <h1 className="text-4xl font-bold mb-4">상세 페이지</h1>
                    <p className="text-gray-600 text-xl mb-8">라우트: {currentRoute}</p>
                    <div className="bg-gray-50 p-8 rounded-xl">
                      <p className="text-gray-700 leading-relaxed">여기에 실제 데이터가 표시됩니다.</p>
                    </div>
                  </div>
                </div>
              </div>
            );
          }
          
          return (
            <div className="h-screen bg-gray-900 flex flex-col overflow-hidden">
              <header className="px-6 py-3 bg-gray-800 flex items-center justify-between">
                <div>
                  <h1 className="text-xl font-bold text-white">MY SPORT</h1>
                  <p className="text-gray-400 text-xs">
                    {liveRankings ? (
                      <span className="text-green-400">
                        실시간 업데이트 ({formatUpdateTime(liveRankings.lastUpdated)})
                      </span>
                    ) : (
                      <span className="text-yellow-400">
                        실시간 데이터 준비 중...
                      </span>
                    )}
                  </p>
                </div>
                <p className="text-gray-500 text-xs">나만 보는 페이지</p>
              </header>
              <div className="flex-1 grid grid-cols-2 grid-rows-2 gap-0">
                {layout.map((card, index) => (
                  <SportCard
                    key={card?.id || `empty-${index}`}
                    data={card}
                    onClick={() => card && handleCardClick(card.route)}
                  />
                ))}
              </div>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<SportsDashboard />);
    </script>
</body>
</html>
